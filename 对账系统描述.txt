对账系统是校验园区食堂刷卡数据中是否存在已扣钱但是数据未到账的情况，并且刷选出来生成excel让运维人员时时维护。整个项目分为两大部分，对账功能和后台管理。对账功能是通过一个quart与spring整合的定时任务来触发，读取相应的元数据excel进行遍历缓存，然后调用存储过程将数据与数据库中的数据进行比对，生成差错数据持久化到另一个主数据库，并且这个过程是多线程完成的，也就是说如果有多个子数据库参与业务，就有多少个线程同时执行，为了保证线程安全，且项目涉及到多数据源的时时切换，所以新建了一个继承了spring框架的AbstractRoutingDataSource的抽象类作为动态数据源，并且jndi存放于ThreadLocal中确保宪政安全，数据源采用阿里巴巴的数据源，并且此数据源配置也是动态的，不是采用配置文件的方式配置死了，而是将数据源的配置信息持久化与数据库中，当项目加载的时候将诸多数据源信息加载近内存，操作excel采用poi，连接ftp服务器采用apache的common.net包，当定时任务触发后，系统会取远程ftp服务器拉取元数据excel，然后解析，缓存进内存且备份数据库，数据比对生成差错数据。而另一重要的部分就是后台管理模块，主要动态配置数据源，查看错误日志(一般日志和重要日志)，以便于运维人员每天时时处理，后台还涉及到了用户的权限管理，在项目中是通过filter和aop结合使用来校验权限，后台管理还可以时时开启和关闭每天的对账定时任务，有效灵活的控制了业务流程。